/**
 * AVATAR ATOM STYLES - ENHANCED DESIGN SYSTEM
 * 
 * Comprehensive avatar styles with design tokens, variants, accessibility,
 * and multi-modal support for user profile displays.
 */

.avatar {
  /* Base avatar styling */
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  
  /* Layout */
  flex-shrink: 0;
  overflow: hidden;
  
  /* Typography */
  font-family: var(--font-family-sans, ui-sans-serif, system-ui, sans-serif);
  font-weight: var(--font-weight-medium, 500);
  
  /* Colors */
  background-color: var(--color-neutral-100, #f4f4f5);
  color: var(--color-neutral-600, #52525b);
  
  /* Interactions */
  user-select: none;
  
  /* Transitions */
  transition: all var(--camera-transition-fast, 150ms) ease-out;
  
  /* Ensure proper stacking */
  z-index: 1;
}

/* Size Variants */
.xs {
  width: var(--spacing-6, 1.5rem);
  height: var(--spacing-6, 1.5rem);
  font-size: var(--font-size-xs, 0.75rem);
}

.sm {
  width: var(--spacing-8, 2rem);
  height: var(--spacing-8, 2rem);
  font-size: var(--font-size-sm, 0.875rem);
}

.md {
  width: var(--spacing-10, 2.5rem);
  height: var(--spacing-10, 2.5rem);
  font-size: var(--font-size-base, 1rem);
}

.lg {
  width: var(--spacing-12, 3rem);
  height: var(--spacing-12, 3rem);
  font-size: var(--font-size-lg, 1.125rem);
}

.xl {
  width: var(--spacing-16, 4rem);
  height: var(--spacing-16, 4rem);
  font-size: var(--font-size-xl, 1.25rem);
}

.2xl {
  width: var(--spacing-20, 5rem);
  height: var(--spacing-20, 5rem);
  font-size: var(--font-size-2xl, 1.5rem);
}

/* Shape Variants */
.circle {
  border-radius: var(--border-radius-full, 9999px);
}

.square {
  border-radius: var(--border-radius-none, 0);
}

.rounded {
  border-radius: var(--border-radius-lg, 0.5rem);
}

/* Content Styling */
.image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: inherit;
}

.initials {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: inherit;
  font-weight: var(--font-weight-medium, 500);
  line-height: 1;
  border-radius: inherit;
}

.icon {
  width: 60%;
  height: 60%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: currentColor;
  opacity: 0.8;
}

.fallback {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: inherit;
  color: currentColor;
}

/* Status Indicator */
.withStatus {
  /* Reserve space for status indicator */
}

.status {
  position: absolute;
  width: 25%;
  height: 25%;
  min-width: var(--spacing-2, 0.5rem);
  min-height: var(--spacing-2, 0.5rem);
  border-radius: var(--border-radius-full, 9999px);
  border: 2px solid var(--color-white, #ffffff);
  bottom: 0;
  right: 0;
  transform: translate(25%, 25%);
  z-index: 2;
}

.status.online {
  background-color: var(--color-semantic-success, #10b981);
}

.status.offline {
  background-color: var(--color-neutral-400, #a1a1aa);
}

.status.away {
  background-color: var(--color-semantic-warning, #f59e0b);
}

.status.busy {
  background-color: var(--color-semantic-error, #ef4444);
}

.status.invisible {
  background-color: var(--color-neutral-400, #a1a1aa);
  opacity: 0.5;
}

/* Multi-Modal Context Variants */
.voice {
  border: 2px solid var(--multimodal-voice-active, #10b981);
}

.voice .status {
  border-color: var(--multimodal-voice-active, #10b981);
}

.camera {
  border: 2px solid var(--multimodal-camera-active, #0ea5e9);
}

.camera .status {
  border-color: var(--multimodal-camera-active, #0ea5e9);
}

.text {
  border: 2px solid var(--multimodal-text-active, #71717a);
}

.text .status {
  border-color: var(--multimodal-text-active, #71717a);
}

.multimodal {
  border: 2px solid var(--multimodal-coordination, #ec4899);
  position: relative;
}

.multimodal::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(
    135deg,
    var(--multimodal-voice-active, #10b981) 0%,
    var(--multimodal-camera-active, #0ea5e9) 50%,
    var(--multimodal-coordination, #ec4899) 100%
  );
  border-radius: inherit;
  z-index: -1;
  background-size: 200% 200%;
  animation: multimodalGradient 3s ease infinite;
}

@keyframes multimodalGradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.multimodal .status {
  border-color: var(--multimodal-coordination, #ec4899);
}

/* Interactive States */
.interactive {
  cursor: pointer;
}

.interactive:hover {
  opacity: 0.9;
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.interactive:active {
  transform: scale(0.98);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.interactive:focus-visible {
  outline: var(--accessibility-focus-width, 2px) solid var(--accessibility-focus-color, #0ea5e9);
  outline-offset: var(--accessibility-focus-offset, 2px);
}

/* Disabled State */
.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* Loading State */
.loading {
  background-color: var(--color-neutral-200, #e4e4e7);
}

.loadingSpinner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
}

.spinner {
  width: 40%;
  height: 40%;
  min-width: var(--spacing-3, 0.75rem);
  min-height: var(--spacing-3, 0.75rem);
  animation: spin 1s linear infinite;
}

.spinnerCircle {
  stroke: var(--color-primary-500, #0ea5e9);
  stroke-linecap: round;
  stroke-dasharray: 31.416;
  stroke-dashoffset: 31.416;
  animation: spinnerDash 1.5s ease-in-out infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@keyframes spinnerDash {
  0% {
    stroke-dasharray: 1, 200;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 200;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 200;
    stroke-dashoffset: -124;
  }
}

/* Border Styling */
.withBorder {
  border: 2px solid var(--color-white, #ffffff);
  box-shadow: 0 0 0 1px var(--color-neutral-200, #e4e4e7);
}

/* Group Avatar Styling */
.group {
  position: relative;
}

.group::after {
  content: '';
  position: absolute;
  top: -2px;
  right: -2px;
  width: 30%;
  height: 30%;
  background-color: var(--color-blue-500, #3b82f6);
  border: 2px solid var(--color-white, #ffffff);
  border-radius: var(--border-radius-full, 9999px);
  z-index: 3;
}

/* High Contrast Mode Support */
@media (prefers-contrast: high) {
  .avatar {
    border: 2px solid currentColor;
  }
  
  .withBorder {
    border-width: 3px;
  }
  
  .status {
    border-width: 3px;
  }
  
  .interactive:focus-visible {
    outline-width: 3px;
    outline-color: currentColor;
  }
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
  .avatar {
    transition: none;
  }
  
  .interactive:hover {
    transform: none;
  }
  
  .interactive:active {
    transform: none;
  }
  
  .spinner,
  .spinnerCircle {
    animation: none;
  }
  
  .multimodal::before {
    animation: none;
    background: var(--multimodal-coordination, #ec4899);
  }
}

/* Dark Mode Support */
@media (prefers-color-scheme: dark) {
  .avatar {
    background-color: var(--color-neutral-700, #3f3f46);
    color: var(--color-neutral-300, #d4d4d8);
  }
  
  .withBorder {
    border-color: var(--color-neutral-800, #27272a);
    box-shadow: 0 0 0 1px var(--color-neutral-600, #52525b);
  }
  
  .status {
    border-color: var(--color-neutral-800, #27272a);
  }
  
  .loading {
    background-color: var(--color-neutral-600, #52525b);
  }
}

/* Print Styles */
@media print {
  .avatar {
    background: white !important;
    color: black !important;
    border: 1px solid black !important;
    box-shadow: none !important;
    animation: none !important;
    transition: none !important;
  }
  
  .multimodal::before {
    display: none !important;
  }
  
  .status {
    border: 1px solid black !important;
    background: white !important;
  }
  
  .spinner {
    display: none !important;
  }
}

/* Mobile Touch Optimization */
@media (hover: none) and (pointer: coarse) {
  .interactive {
    /* Ensure adequate touch target */
    min-width: var(--camera-touch-target, 44px);
    min-height: var(--camera-touch-target, 44px);
  }
  
  .interactive:hover {
    /* Remove hover effects on touch devices */
    opacity: 1;
    transform: none;
    box-shadow: none;
  }
  
  .interactive:active {
    /* Provide tactile feedback on touch */
    opacity: 0.8;
    transform: scale(0.95);
  }
}

/* Responsive Size Adjustments */
@media (max-width: 640px) {
  .2xl {
    width: var(--spacing-16, 4rem);
    height: var(--spacing-16, 4rem);
    font-size: var(--font-size-xl, 1.25rem);
  }
  
  .xl {
    width: var(--spacing-12, 3rem);
    height: var(--spacing-12, 3rem);
    font-size: var(--font-size-lg, 1.125rem);
  }
}

/* Enhanced accessibility for screen readers */
.avatar[aria-busy="true"] {
  /* Loading state announcement */
}

.avatar[aria-disabled="true"] {
  /* Disabled state announcement */
}

/* Performance optimizations */
.avatar {
  /* Promote to GPU layer for smooth animations */
  will-change: transform;
  transform: translateZ(0);
}

/* Ensure proper image loading */
.image {
  /* Prevent image dragging */
  -webkit-user-drag: none;
  user-drag: none;
  
  /* Optimize image rendering */
  image-rendering: optimizeQuality;
}

/* Status indicator positioning for different sizes */
.xs .status {
  width: var(--spacing-2, 0.5rem);
  height: var(--spacing-2, 0.5rem);
  border-width: 1px;
}

.sm .status {
  width: var(--spacing-2, 0.5rem);
  height: var(--spacing-2, 0.5rem);
  border-width: 1px;
}

.md .status {
  width: var(--spacing-3, 0.75rem);
  height: var(--spacing-3, 0.75rem);
  border-width: 2px;
}

.lg .status {
  width: var(--spacing-3, 0.75rem);
  height: var(--spacing-3, 0.75rem);
  border-width: 2px;
}

.xl .status {
  width: var(--spacing-4, 1rem);
  height: var(--spacing-4, 1rem);
  border-width: 2px;
}

.2xl .status {
  width: var(--spacing-5, 1.25rem);
  height: var(--spacing-5, 1.25rem);
  border-width: 3px;
}
